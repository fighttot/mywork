import{_ as L,a as P,b as E,c as F,d as N,e as T}from"./kokkoro5-b37e87e4.js";import{b as X,d as $,a as j,r as q,c as z,U as H,I as m,X as R,e as U,o as i,f as g,j as o,i as t,l as n,V as c,Z as W,_ as Y,F as A,p as D,m as h,E as y,z as f,x,a4 as M,a5 as Z,k as b,s as w}from"./index-80f2aa65.js";import{F as G}from"./FooTer-4c628033.js";import{p as J}from"./parallax-d6fc0e84.js";import{g as K}from"./index-4db78ffb.js";import{V as O}from"./VContainer-6544446b.js";import{V as Q,a as k}from"./VRow-49881bac.js";/* empty css              */const tt=""+new URL("Shoukaku-5e278418.jpg",import.meta.url).href,ot={class:"likeview"},et={class:"othertitle"},st={class:"bgbox"},lt={class:"scene"},at={class:"imgbox","data-depth":"-0.5"},rt={class:"d-flex align-center justify-center fill-height"},nt=t("div",{class:"bgbox2"},null,-1),ct=t("h1",null,"收藏",-1),it=t("thead",null,[t("tr",null,[t("th",null,"圖片"),t("th",null,"名稱"),t("th",null,"單價"),t("th",null,"上架狀態"),t("th",null,"移除")])],-1),dt=t("br",null,null,-1),ut={key:0,colspan:"6",class:"text-center"},bt={__name:"LikeView",setup(pt){const p=X(),C=$(),d=j(),r=q([]),V=async l=>{try{const{data:s}=await m.post("users/like",{product:l}),a=r.value.findIndex(e=>e.product._id===l);r.value.splice(a,1),d.like=s.result.length}catch(s){console.log(s),p({text:s.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom",rounded:"pill",variant:"tonal"}})}},S=z(()=>r.value.length>0&&!r.value.some(l=>!l.product.sell)),B=async l=>{try{const s=r.value.findIndex(e=>e.product._id===l);console.log(s);const{data:a}=await m.post("/users/likeoversing",{product:l});r.value.splice(s,1),d.like=a.result.like,d.cart=a.result.cart}catch(s){p({text:s.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom",rounded:"pill",variant:"tonal"}})}},I=async(l,s)=>{try{const{data:a}=await m.post("/users/likeover");d.like=0,d.cart=a.result,C.push("/cart")}catch(a){console.log(a),p({text:a.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom",rounded:"pill",variant:"tonal"}})}};return H(async()=>{try{const{data:u}=await m.get("/users/like");r.value.push(...u.result)}catch(u){p({text:u.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom",rounded:"pill",variant:"tonal"}})}await R();const l=window.innerWidth,s=window.innerHeight;K.timeline({defaults:{duration:6,ease:"linear"},repeat:-1}).to(".scrolling1",{y:s/2}).to(".scrolling1",{opacity:0,duration:0}).to(".scrolling",{opacity:1,duration:0}).to(".scrolling",{x:l-100,duration:10}).to(".scrolling",{opacity:0,duration:0}).to(".scrolling2",{opacity:1,duration:0}).to(".scrolling2",{y:-s/2}).to(".scrolling2",{opacity:0,duration:0}).to(".scrolling3",{opacity:1,duration:0}).to(".scrolling3",{y:s/2}).to(".scrolling3",{opacity:0,duration:0}).to(".scrolling4",{opacity:1,duration:0}).to(".scrolling4",{x:-l+100,duration:10}).to(".scrolling4",{opacity:0,duration:0}).to(".scrolling5",{opacity:1,duration:0}).to(".scrolling5",{y:-s/2});const e=document.querySelector(".scene"),_=document.querySelector(".bgbox"),v=new J(e,{scalarX:10,scalarY:10,frictionX:.1,frictionY:.1,limitX:100,limitY:100});v.disable(),_.addEventListener("mouseover",u=>{v.enable()}),_.addEventListener("mouseout",u=>{v.disable()}),d.loding=!1}),(l,s)=>{const a=U("router-link");return i(),g("section",ot,[o(c,{src:L,cover:"",class:"scrolling"}),o(c,{src:P,cover:"",class:"scrolling1"}),o(c,{src:E,cover:"",class:"scrolling2"}),o(c,{src:F,cover:"",class:"scrolling3"}),o(c,{src:N,cover:"",class:"scrolling4"}),o(c,{src:T,cover:"",class:"scrolling5"}),t("section",et,[t("div",st,[t("div",lt,[t("div",at,[o(c,{class:"mainimg",src:tt,cover:""},{placeholder:n(()=>[t("div",rt,[o(W,{color:"grey-lighten-4",indeterminate:""})])]),_:1})])])]),nt]),o(O,null,{default:n(()=>[o(Q,null,{default:n(()=>[o(k,{cols:"12"},{default:n(()=>[ct]),_:1}),o(k,{cols:"12",class:"likeheight"},{default:n(()=>[o(Y,null,{default:n(()=>[it,t("tbody",null,[(i(!0),g(A,null,D(r.value,e=>(i(),g("tr",{key:e._id,class:M({"bg-red-lighten-5":!e.product.sell})},[t("td",null,[o(c,{src:e.product.images[0],cover:"","aspect-ratio":"1"},null,8,["src"])]),t("td",{style:Z(`color: ${e.product.textColor};`)},[o(a,{to:`/proHome/${e.product._id}`},{default:n(()=>[x(y(e.product.name),1)]),_:2},1032,["to"])],4),t("td",null,y(e.product.price),1),t("td",null,[e.product.sell?(i(),b(w,{key:0,icon:"mdi-check"})):h("",!0),e.product.sell?h("",!0):(i(),b(w,{key:1,icon:"mdi-close"}))]),t("td",null,[o(f,{color:"primary",variant:"text",icon:"mdi-heart-broken",onClick:_=>V(e.product._id)},null,8,["onClick"]),dt,e.product.sell?(i(),b(f,{key:0,color:"primary",variant:"text",icon:"mdi-cart",onClick:_=>B(e.product._id)},null,8,["onClick"])):h("",!0)])],2))),128)),t("tr",null,[r.value.length===0?(i(),g("td",ut,"沒有收藏")):h("",!0)])])]),_:1})]),_:1}),o(k,{cols:"12",class:"text-center"},{default:n(()=>[t("p",null,"總收藏:"+y(r.value.length),1)]),_:1}),o(k,{cols:"12",class:"text-center"},{default:n(()=>[o(f,{class:"btnlick",onClick:I,disabled:!S.value},{default:n(()=>[x("全部加入購物車")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),o(G)])}}};export{bt as default};
