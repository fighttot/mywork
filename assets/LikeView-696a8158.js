import{b as S,d as P,a as F,r as I,c as L,H as d,o as N,e as X,f as c,h as p,x as t,i as s,w as n,m as g,X as Y,Y as $,F as j,n as q,k as _,D as m,y as k,t as v,a2 as R,a3 as T,j as f,q as b}from"./index-d6fa05ad.js";import{F as z}from"./FooTer-1e4a18d8.js";import{p as A}from"./parallax-e593605e.js";import{V as D}from"./VContainer-884fb091.js";import{V as H,a as h}from"./VRow-2ac63005.js";/* empty css              */const U=""+new URL("Shoukaku-5e278418.jpg",import.meta.url).href,E={class:"likeview"},M={class:"othertitle"},G={class:"bgbox"},J={class:"scene"},K={class:"imgbox","data-depth":"-0.5"},O={class:"d-flex align-center justify-center fill-height"},Q=t("div",{class:"bgbox2"},null,-1),W=t("h1",null,"收藏",-1),Z=t("thead",null,[t("tr",null,[t("th",null,"圖片"),t("th",null,"名稱"),t("th",null,"單價"),t("th",null,"上架狀態"),t("th",null,"移除")])],-1),tt=t("br",null,null,-1),et={key:0,colspan:"6",class:"text-center"},it={__name:"LikeView",setup(ot){const u=S(),x=P(),i=F(),r=I([]),y=async o=>{try{const{data:l}=await d.post("users/like",{product:o}),a=r.value.findIndex(e=>e.product._id===o);r.value.splice(a,1),i.like=l.result.length}catch(l){console.log(l),u({text:l.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom",rounded:"pill",variant:"tonal"}})}},C=L(()=>r.value.length>0&&!r.value.some(o=>!o.product.sell)),w=async o=>{try{const l=r.value.findIndex(e=>e.product._id===o);console.log(l);const{data:a}=await d.post("/users/likeoversing",{product:o});r.value.splice(l,1),i.like=a.result.like,i.cart=a.result.cart}catch(l){u({text:l.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom",rounded:"pill",variant:"tonal"}})}},V=async(o,l)=>{try{const{data:a}=await d.post("/users/likeover");i.like=0,i.cart=a.result,x.push("/cart")}catch(a){console.log(a),u({text:a.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom",rounded:"pill",variant:"tonal"}})}};return(async()=>{try{const{data:o}=await d.get("/users/like");r.value.push(...o.result)}catch(o){u({text:o.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom",rounded:"pill",variant:"tonal"}})}})(),N(()=>{const o=document.querySelector(".scene");new A(o,{scalarX:10,scalarY:10,frictionX:.1,frictionY:.1,limitX:100,limitY:100})}),(o,l)=>{const a=X("router-link");return c(),p("section",E,[t("section",M,[t("div",G,[t("div",J,[t("div",K,[s(g,{class:"mainimg",src:U,cover:""},{placeholder:n(()=>[t("div",O,[s(Y,{color:"grey-lighten-4",indeterminate:""})])]),_:1})])])]),Q]),s(D,null,{default:n(()=>[s(H,null,{default:n(()=>[s(h,{cols:"12"},{default:n(()=>[W]),_:1}),s(h,{cols:"12",class:"likeheight"},{default:n(()=>[s($,null,{default:n(()=>[Z,t("tbody",null,[(c(!0),p(j,null,q(r.value,e=>(c(),p("tr",{key:e._id,class:R({"bg-red-lighten-5":!e.product.sell})},[t("td",null,[s(g,{src:e.product.images[0],cover:"","aspect-ratio":"1"},null,8,["src"])]),t("td",{style:T(`color: ${e.product.textColor};`)},[s(a,{to:`/proHome/${e.product._id}`},{default:n(()=>[v(m(e.product.name),1)]),_:2},1032,["to"])],4),t("td",null,m(e.product.price),1),t("td",null,[e.product.sell?(c(),f(b,{key:0,icon:"mdi-check"})):_("",!0),e.product.sell?_("",!0):(c(),f(b,{key:1,icon:"mdi-close"}))]),t("td",null,[s(k,{color:"primary",variant:"text",icon:"mdi-heart-broken",onClick:B=>y(e.product._id)},null,8,["onClick"]),tt,e.product.sell?(c(),f(k,{key:0,color:"primary",variant:"text",icon:"mdi-cart",onClick:B=>w(e.product._id)},null,8,["onClick"])):_("",!0)])],2))),128)),t("tr",null,[r.value.length===0?(c(),p("td",et,"沒有收藏")):_("",!0)])])]),_:1})]),_:1}),s(h,{cols:"12",class:"text-center"},{default:n(()=>[t("p",null,"總收藏:"+m(r.value.length),1)]),_:1}),s(h,{cols:"12",class:"text-center"},{default:n(()=>[s(k,{class:"btnlick",onClick:V,disabled:!C.value},{default:n(()=>[v("全部加入購物車")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),s(z)])}}};export{it as default};
