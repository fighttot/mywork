import{_ as w}from"./71b8e0fl_cL._AC_SL1500-811e8b6d.js";import{b as C,r as V,I as g,o as u,f as s,i as l,j as e,l as o,V as x,x as _,_ as m,F as c,p as r,E as n,z as f,m as b}from"./index-b6fafbca.js";import{F as D}from"./FooTer-21f1a44d.js";import{V as S}from"./VContainer-897ff6ef.js";import{V as L,a as h}from"./VRow-d4423488.js";/* empty css              */const B={class:"backadminO"},I={class:"backtop"},q={class:"bgbox"},F=l("div",{class:"bgbox2"},null,-1),N=l("h1",null,"訂單管理",-1),$=l("thead",null,[l("tr",null,[l("th",null,"ID"),l("th",null,"建立日期"),l("th",null,"使用者"),l("th",null,"金額"),l("th",null,"商品"),l("th",null,"狀態"),l("th",null,"付款方式"),l("th",null,"地址"),l("th",null,"修改日期"),l("th",null,"編輯")])],-1),T=l("thead",null,[l("tr",null,[l("th",null,"ID"),l("th",null,"建立日期"),l("th",null,"使用者"),l("th",null,"金額"),l("th",null,"商品"),l("th",null,"狀態"),l("th",null,"付款方式"),l("th",null,"地址"),l("th",null,"修改日期"),l("th",null,"編輯")])],-1),E=l("td",null," 已完成無法編輯 ",-1),O=l("thead",null,[l("tr",null,[l("th",null,"ID"),l("th",null,"建立日期"),l("th",null,"使用者"),l("th",null,"金額"),l("th",null,"商品"),l("th",null,"狀態"),l("th",null,"付款方式"),l("th",null,"地址"),l("th",null,"修改日期"),l("th",null,"編輯")])],-1),P=l("td",null," 已取消無法編輯 ",-1),K={__name:"OrdersView",setup(j){const y=C(),d=V([]),p=async(i,k)=>{try{const t=await g.post("/orders/editorder",{id:i,check:k}),a=d.value.findIndex(v=>v._id===i);d.value[a].ok=t.data.result.ok,d.value[a].changedate=t.data.result.changedate}catch(t){console.log(t),y({text:t.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom",rounded:"pill",variant:"tonal"}})}};return(async()=>{try{const{data:i}=await g.get("/orders/all");d.value.push(...i.result.map(k=>(k.total=k.cart.reduce((t,a)=>t+a.product.price*a.quantity,0),k))),console.log(d.value.length)}catch(i){y({text:i.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom",rounded:"pill",variant:"tonal"}})}})(),(i,k)=>(u(),s("section",B,[l("section",I,[l("div",q,[e(x,{class:"mainimg",src:w,cover:""})]),F]),e(S,null,{default:o(()=>[e(L,null,{default:o(()=>[e(h,{cols:"12"},{default:o(()=>[N]),_:1}),e(h,{cols:"12"},{default:o(()=>[_("處理中的訂單")]),_:1}),e(h,{cols:"12"},{default:o(()=>[e(m,null,{default:o(()=>[$,l("tbody",null,[(u(!0),s(c,null,r(d.value,t=>(u(),s("tr",{key:t._id},[t.ok!=="訂單已完成"&&t.ok!=="訂單已取消"?(u(),s(c,{key:0},[l("td",null,n(t._id),1),l("td",null,n(new Date(t.date).toLocaleString()),1),l("td",null,n(t.user.account),1),l("td",null,n(t.total),1),l("td",null,[l("ul",null,[(u(!0),s(c,null,r(t.cart,a=>(u(),s("li",{key:a._id},n(a.product.name)+"*"+n(a.quantity),1))),128))])]),l("td",null,n(t.ok),1),l("td",null,n(t.paywat),1),l("td",null,n(t.seventhome),1),l("td",null,n(new Date(t.changedate).toLocaleString()),1),l("td",null,[e(f,{onClick:a=>p(t._id,2),disabled:t.ok!=="訂單確認中"},{default:o(()=>[_(" 成立訂單")]),_:2},1032,["onClick","disabled"]),e(f,{onClick:a=>p(t._id,3),disabled:!(t.ok==="訂單已成立"||t.ok==="結單無法取消")},{default:o(()=>[_(" 完成訂單 ")]),_:2},1032,["onClick","disabled"]),e(f,{onClick:a=>p(t._id,6),disabled:t.ok!=="取消確認中"},{default:o(()=>[_(" 結單無法取消 ")]),_:2},1032,["onClick","disabled"]),e(f,{onClick:a=>p(t._id,4),disabled:t.ok==="訂單已完成"||t.ok==="訂單已取消"||t.ok==="結單無法取消"},{default:o(()=>[_(" 取消訂單 ")]),_:2},1032,["onClick","disabled"])])],64)):b("",!0)]))),128))])]),_:1})]),_:1}),e(h,{cols:"12"},{default:o(()=>[_("完成的訂單")]),_:1}),e(h,{cols:"12"},{default:o(()=>[e(m,null,{default:o(()=>[T,l("tbody",null,[(u(!0),s(c,null,r(d.value,t=>(u(),s("tr",{key:t._id},[t.ok==="訂單已完成"?(u(),s(c,{key:0},[l("td",null,n(t._id),1),l("td",null,n(new Date(t.date).toLocaleString()),1),l("td",null,n(t.user.account),1),l("td",null,n(t.total),1),l("td",null,[l("ul",null,[(u(!0),s(c,null,r(t.cart,a=>(u(),s("li",{key:a._id},n(a.product.name)+"*"+n(a.quantity),1))),128))])]),l("td",null,n(t.ok),1),l("td",null,n(t.paywat),1),l("td",null,n(t.seventhome),1),l("td",null,n(new Date(t.changedate).toLocaleString()),1),E],64)):b("",!0)]))),128))])]),_:1})]),_:1}),e(h,{cols:"12"},{default:o(()=>[_("取消的訂單")]),_:1}),e(h,{cols:"12"},{default:o(()=>[e(m,null,{default:o(()=>[O,l("tbody",null,[(u(!0),s(c,null,r(d.value,t=>(u(),s("tr",{key:t._id},[t.ok==="訂單已取消"?(u(),s(c,{key:0},[l("td",null,n(t._id),1),l("td",null,n(new Date(t.date).toLocaleString()),1),l("td",null,n(t.user.account),1),l("td",null,n(t.total),1),l("td",null,[l("ul",null,[(u(!0),s(c,null,r(t.cart,a=>(u(),s("li",{key:a._id},n(a.product.name)+"*"+n(a.quantity),1))),128))])]),l("td",null,n(t.ok),1),l("td",null,n(t.paywat),1),l("td",null,n(t.seventhome),1),l("td",null,n(new Date(t.changedate).toLocaleString()),1),P],64)):b("",!0)]))),128))])]),_:1})]),_:1})]),_:1})]),_:1}),e(D)]))}};export{K as default};
