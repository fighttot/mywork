import{_ as v}from"./71b8e0fl_cL._AC_SL1500-811e8b6d.js";import{b as y,r as V,H as f,f as i,h as d,x as t,i as s,w as n,F as _,m as w,W as x,n as k,D as e,y as h,t as m}from"./index-0c9fed02.js";import{V as C}from"./VContainer-4e7a447d.js";import{V as B,a as b}from"./VRow-22674c50.js";/* empty css              */const D={class:"othertitle"},S={class:"bgbox"},I=t("div",{class:"bgbox2"},null,-1),L=t("h1",null,"訂單管理",-1),N=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"建立日期"),t("th",null,"使用者"),t("th",null,"金額"),t("th",null,"商品"),t("th",null,"狀態"),t("th",null,"付款方式"),t("th",null,"地址"),t("th",null,"修改日期"),t("th",null,"編輯")])],-1),E={__name:"OrdersView",setup($){const p=y(),c=V([]),r=async(o,u)=>{try{const l=await f.post("/orders/editorder",{id:o,check:u}),a=c.value.findIndex(g=>g._id===o);c.value[a].ok=l.data.result.ok,c.value[a].changedate=l.data.result.changedate}catch(l){console.log(l),p({text:l.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}};return(async()=>{try{const{data:o}=await f.get("/orders/all");c.value.push(...o.result.map(u=>(u.total=u.cart.reduce((l,a)=>l+a.product.price*a.quantity,0),u)))}catch(o){p({text:o.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}})(),(o,u)=>(i(),d(_,null,[t("section",D,[t("div",S,[s(w,{class:"mainimg",src:v,cover:""})]),I]),s(C,null,{default:n(()=>[s(B,null,{default:n(()=>[s(b,{cols:"12"},{default:n(()=>[L]),_:1}),s(b,{cols:"12"},{default:n(()=>[s(x,null,{default:n(()=>[N,t("tbody",null,[(i(!0),d(_,null,k(c.value,l=>(i(),d("tr",{key:l._id},[t("td",null,e(l._id),1),t("td",null,e(new Date(l.date).toLocaleString()),1),t("td",null,e(l.user.account),1),t("td",null,e(l.total),1),t("td",null,[t("ul",null,[(i(!0),d(_,null,k(l.cart,a=>(i(),d("li",{key:a._id},e(a.product.name)+"*"+e(a.quantity),1))),128))])]),t("td",null,e(l.ok),1),t("td",null,e(l.paywat),1),t("td",null,e(l.seventhome),1),t("td",null,e(new Date(l.changedate).toLocaleString()),1),t("td",null,[s(h,{onClick:a=>r(l._id,2),disabled:l.ok!=="訂單確認中"},{default:n(()=>[m(" 成立訂單")]),_:2},1032,["onClick","disabled"]),s(h,{onClick:a=>r(l._id,3),disabled:l.ok!=="訂單已成立"},{default:n(()=>[m(" 完成訂單 ")]),_:2},1032,["onClick","disabled"]),s(h,{onClick:a=>r(l._id,4),disabled:l.ok==="訂單已完成"||l.ok==="訂單已取消"},{default:n(()=>[m("取消訂單")]),_:2},1032,["onClick","disabled"])])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1})],64))}};export{E as default};
