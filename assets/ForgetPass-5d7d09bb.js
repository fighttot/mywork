import{b as U,d as M,a as F,W as V,U as q,o as P,f as R,i as l,j as a,l as o,V as _,G as E,h as s,a1 as N,a3 as n,z as w,x as h}from"./index-4da1c3a6.js";import{_ as $}from"./71b8e0fl_cL._AC_SL1500-811e8b6d.js";import{v as T}from"./index-7fad57a4.js";import{c as j,a as u,d as z,u as D,b as i,V as G}from"./index.esm-152e704f.js";import{V as I}from"./VContainer-69f72ce6.js";import{V as x,a as g}from"./VRow-d99317f6.js";/* empty css              */const L=""+new URL("rikka-takanashi-takanashi-rikka-b85019f4.gif",import.meta.url).href,O={class:"forgerpass"},W={class:"othertitle"},A={class:"bgbox"},H=l("div",{class:"bgbox2"},null,-1),J=l("h1",null,"忘記密碼",-1),K={class:"text-center"},te={__name:"ForgetPass",setup(Q){const m=U(),k=M(),v=F(),C=j({account:u().required("帳號必填").min(4,"最少四個字").max(20,"最多20"),email:u().required("信箱必填").test("isEmail","信箱格式錯誤",t=>T.isEmail(t)),password:u().required("密碼必填").min(4,"最少四個字").max(20,"最多20"),passwordConfirm:u().required("密碼必填").min(4,"最少四個字").max(20,"最多20").oneOf([z("password")],"密碼不一致")}),{handleSubmit:S,isSubmitting:y,handleReset:b}=D({validationSchema:C}),d=i("account"),c=i("email"),p=i("password"),f=i("passwordConfirm"),B=S(async t=>{try{await V.post("/users/forget",{account:t.account,email:t.email,password:t.password}),m({text:"修改成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom",rounded:"pill",variant:"tonal"}});const{data:e}=await V.post("/users/login",{account:t.account,password:t.password});v.login({token:e.result.token,account:e.result.account,name:e.result.name,email:e.result.email,cart:e.result.cart,role:e.result.role,like:e.result.like}),m({text:"登入成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom",rounded:"pill",variant:"tonal"}}),b(),k.push("/")}catch(e){m({text:e.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom",rounded:"pill",variant:"tonal"}})}});return q(()=>{v.loding=!1}),(t,e)=>(P(),R("section",O,[l("section",W,[l("div",A,[a(_,{class:"mainimg",src:$,cover:""})]),H]),a(I,null,{default:o(()=>[a(x,null,{default:o(()=>[a(g,{cols:"12",class:"text-center"},{default:o(()=>[J]),_:1}),a(E),a(x,null,{default:o(()=>[a(g,{cols:"6"},{default:o(()=>[a(_,{src:L,style:{height:"500px"}})]),_:1}),a(g,{cols:"6"},{default:o(()=>[a(G,{disabled:s(y),onSubmit:N(s(B),["prevent"])},{default:o(()=>[a(n,{modelValue:s(d).value.value,"onUpdate:modelValue":e[0]||(e[0]=r=>s(d).value.value=r),label:"帳號:",counter:"","max-length":"20","error-messages":s(d).errorMessage.value},null,8,["modelValue","error-messages"]),a(n,{modelValue:s(p).value.value,"onUpdate:modelValue":e[1]||(e[1]=r=>s(p).value.value=r),label:"密碼:",counter:"","max-length":"20",type:"password","error-messages":s(p).errorMessage.value},null,8,["modelValue","error-messages"]),a(n,{modelValue:s(f).value.value,"onUpdate:modelValue":e[2]||(e[2]=r=>s(f).value.value=r),label:"確認密碼:",counter:"","max-length":"20",type:"password","error-messages":s(f).errorMessage.value},null,8,["modelValue","error-messages"]),a(n,{modelValue:s(c).value.value,"onUpdate:modelValue":e[3]||(e[3]=r=>s(c).value.value=r),label:"確認信箱",type:"email","error-messages":s(c).errorMessage.value},null,8,["modelValue","error-messages"]),l("div",K,[a(w,{type:"submit"},{default:o(()=>[h("創新密碼")]),_:1}),a(w,{onClick:s(b)},{default:o(()=>[h("重製")]),_:1},8,["onClick"])])]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1})]))}};export{te as default};
