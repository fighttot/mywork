import{b as S,d as L,a as I,r as P,c as q,H as d,o as F,e as N,f as c,h as p,x as e,i as a,w as n,m as b,X,Y,F as $,n as j,k as _,D as m,y as k,t as g,a2 as E,a3 as R,j as v,q as f}from"./index-3263188b.js";import{F as T}from"./FooTer-376ed45d.js";import{p as z}from"./parallax-8993438f.js";import{V as A}from"./VContainer-2369b5fb.js";import{V as D,a as h}from"./VRow-dbeb81d2.js";/* empty css              */const H=""+new URL("Shoukaku-5e278418.jpg",import.meta.url).href,U={class:"likeview"},M={class:"othertitle"},G={class:"bgbox"},J={class:"scene"},K={class:"imgbox","data-depth":"-0.5"},O={class:"d-flex align-center justify-center fill-height"},Q=e("div",{class:"bgbox2"},null,-1),W=e("h1",null,"收藏",-1),Z=e("thead",null,[e("tr",null,[e("th",null,"圖片"),e("th",null,"名稱"),e("th",null,"單價"),e("th",null,"上架狀態"),e("th",null,"移除")])],-1),ee=e("br",null,null,-1),te={key:0,colspan:"6",class:"text-center"},ie={__name:"LikeView",setup(oe){const u=S(),x=L(),i=I(),r=P([]),y=async o=>{try{const{data:l}=await d.post("users/like",{product:o}),s=r.value.findIndex(t=>t.product._id===o);r.value.splice(s,1),i.like=l.result.length}catch(l){console.log(l),u({text:l.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom",rounded:"pill",variant:"tonal"}})}},C=q(()=>r.value.length>0&&!r.value.some(o=>!o.product.sell)),w=async o=>{try{const l=r.value.findIndex(t=>t.product._id===o);console.log(l);const{data:s}=await d.post("/users/likeoversing",{product:o});r.value.splice(l,1),i.like=s.result.like,i.cart=s.result.cart}catch(l){u({text:l.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom",rounded:"pill",variant:"tonal"}})}},V=async(o,l)=>{try{const{data:s}=await d.post("/users/likeover");i.like=0,i.cart=s.result,x.push("/cart")}catch(s){console.log(s),u({text:s.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom",rounded:"pill",variant:"tonal"}})}};return(async()=>{try{const{data:o}=await d.get("/users/like");r.value.push(...o.result)}catch(o){u({text:o.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom",rounded:"pill",variant:"tonal"}})}})(),F(()=>{const o=document.querySelector(".scene"),l=document.querySelector(".bgbox"),s=new z(o,{scalarX:10,scalarY:10,frictionX:.1,frictionY:.1,limitX:100,limitY:100});s.disable(),l.addEventListener("mouseover",t=>{s.enable()}),l.addEventListener("mouseout",t=>{s.disable()})}),(o,l)=>{const s=N("router-link");return c(),p("section",U,[e("section",M,[e("div",G,[e("div",J,[e("div",K,[a(b,{class:"mainimg",src:H,cover:""},{placeholder:n(()=>[e("div",O,[a(X,{color:"grey-lighten-4",indeterminate:""})])]),_:1})])])]),Q]),a(A,null,{default:n(()=>[a(D,null,{default:n(()=>[a(h,{cols:"12"},{default:n(()=>[W]),_:1}),a(h,{cols:"12",class:"likeheight"},{default:n(()=>[a(Y,null,{default:n(()=>[Z,e("tbody",null,[(c(!0),p($,null,j(r.value,t=>(c(),p("tr",{key:t._id,class:E({"bg-red-lighten-5":!t.product.sell})},[e("td",null,[a(b,{src:t.product.images[0],cover:"","aspect-ratio":"1"},null,8,["src"])]),e("td",{style:R(`color: ${t.product.textColor};`)},[a(s,{to:`/proHome/${t.product._id}`},{default:n(()=>[g(m(t.product.name),1)]),_:2},1032,["to"])],4),e("td",null,m(t.product.price),1),e("td",null,[t.product.sell?(c(),v(f,{key:0,icon:"mdi-check"})):_("",!0),t.product.sell?_("",!0):(c(),v(f,{key:1,icon:"mdi-close"}))]),e("td",null,[a(k,{color:"primary",variant:"text",icon:"mdi-heart-broken",onClick:B=>y(t.product._id)},null,8,["onClick"]),ee,t.product.sell?(c(),v(k,{key:0,color:"primary",variant:"text",icon:"mdi-cart",onClick:B=>w(t.product._id)},null,8,["onClick"])):_("",!0)])],2))),128)),e("tr",null,[r.value.length===0?(c(),p("td",te,"沒有收藏")):_("",!0)])])]),_:1})]),_:1}),a(h,{cols:"12",class:"text-center"},{default:n(()=>[e("p",null,"總收藏:"+m(r.value.length),1)]),_:1}),a(h,{cols:"12",class:"text-center"},{default:n(()=>[a(k,{class:"btnlick",onClick:V,disabled:!C.value},{default:n(()=>[g("全部加入購物車")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),a(T)])}}};export{ie as default};
