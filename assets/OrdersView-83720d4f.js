import{_ as v}from"./71b8e0fl_cL._AC_SL1500-811e8b6d.js";import{b as V,r as x,H as f,f as d,h as i,x as t,i as e,w as n,F as _,m as y,W as C,n as k,D as s,y as h,t as m}from"./index-ddeedb71.js";import{V as w}from"./VContainer-550eacce.js";import{V as B,a as b}from"./VRow-2e90067a.js";/* empty css              */const D={class:"othertitle"},S={class:"bgbox"},I=t("div",{class:"bgbox2"},null,-1),L=t("h1",null,"訂單管理",-1),N=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"建立日期"),t("th",null,"使用者"),t("th",null,"金額"),t("th",null,"商品"),t("th",null,"狀態"),t("th",null,"付款方式"),t("th",null,"地址"),t("th",null,"修改日期"),t("th",null,"編輯")])],-1),$=t("td",null," 貨到付款",-1),H={__name:"OrdersView",setup(q){const p=V(),c=x([]),r=async(o,u)=>{try{const l=await f.post("/orders/editorder",{id:o,check:u}),a=c.value.findIndex(g=>g._id===o);c.value[a].ok=l.data.result.ok,c.value[a].changedate=l.data.result.changedate}catch(l){console.log(l),p({text:l.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}};return(async()=>{try{const{data:o}=await f.get("/orders/all");c.value.push(...o.result.map(u=>(u.total=u.cart.reduce((l,a)=>l+a.product.price*a.quantity,0),u)))}catch(o){p({text:o.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}})(),(o,u)=>(d(),i(_,null,[t("section",D,[t("div",S,[e(y,{class:"mainimg",src:v,cover:""})]),I]),e(w,null,{default:n(()=>[e(B,null,{default:n(()=>[e(b,{cols:"12"},{default:n(()=>[L]),_:1}),e(b,{cols:"12"},{default:n(()=>[e(C,null,{default:n(()=>[N,t("tbody",null,[(d(!0),i(_,null,k(c.value,l=>(d(),i("tr",{key:l._id},[t("td",null,s(l._id),1),t("td",null,s(new Date(l.date).toLocaleString()),1),t("td",null,s(l.user.account),1),t("td",null,s(l.total),1),t("td",null,[t("ul",null,[(d(!0),i(_,null,k(l.cart,a=>(d(),i("li",{key:a._id},s(a.product.name)+"*"+s(a.quantity),1))),128))])]),t("td",null,s(l.ok),1),$,t("td",null,s(l.seventhome),1),t("td",null,s(new Date(l.changedate).toLocaleString()),1),t("td",null,[e(h,{onClick:a=>r(l._id,2),disabled:l.ok!=="訂單確認中"},{default:n(()=>[m(" 成立訂單")]),_:2},1032,["onClick","disabled"]),e(h,{onClick:a=>r(l._id,3),disabled:l.ok!=="訂單已成立"},{default:n(()=>[m(" 完成訂單 ")]),_:2},1032,["onClick","disabled"]),e(h,{onClick:a=>r(l._id,4),disabled:l.ok==="訂單已完成"||l.ok==="訂單已取消"},{default:n(()=>[m("取消訂單")]),_:2},1032,["onClick","disabled"])])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1})],64))}};export{H as default};
