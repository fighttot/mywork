import{b as S,d as $,a as I,r as N,c as P,H as i,e as L,f as n,j as p,w as c,i as r,U as z,y as t,h,p as A,F as D,k,D as m,V as f,v as g,W as F,l as H,X as y,s as b}from"./index-1be14933.js";import{V as R}from"./VContainer-8f0d03c4.js";import{a as _,V as T}from"./VRow-a3c634ac.js";/* empty css              */const U=t("h1",null,"收藏",-1),j=t("thead",null,[t("tr",null,[t("th",null,"圖片"),t("th",null,"名稱"),t("th",null,"單價"),t("th",null,"上架狀態"),t("th",null,"移除")])],-1),q=t("br",null,null,-1),E={key:0,colspan:"6",class:"text-center"},M={__name:"LikeView",setup(W){const d=S(),v=$(),u=I(),a=N([]),x=async o=>{try{const{data:l}=await i.post("users/like",{product:o}),s=a.value.findIndex(e=>e.product._id===o);a.value.splice(s,1),u.like=l.result.length}catch(l){console.log(l),d({text:l.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}},C=P(()=>a.value.length>0&&!a.value.some(o=>!o.product.sell)),V=async o=>{try{const l=a.value.findIndex(e=>e.product._id===o);console.log(l);const{data:s}=await i.post("/users/likeoversing",{product:o});a.value.splice(l,1),u.like=s.result.like,u.cart=s.result.cart}catch(l){d({text:l.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}},w=async(o,l)=>{try{const{data:s}=await i.post("/users/likeover");u.like=0,u.cart=s.result,v.push("/cart")}catch(s){console.log(s),d({text:s.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}};return(async()=>{try{const{data:o}=await i.get("/users/like");a.value.push(...o.result)}catch(o){d({text:o.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}})(),(o,l)=>{const s=L("router-link");return n(),p(R,null,{default:c(()=>[r(T,null,{default:c(()=>[r(_,{cols:"12"},{default:c(()=>[U]),_:1}),r(_,{cols:"12"},{default:c(()=>[r(z,null,{default:c(()=>[j,t("tbody",null,[(n(!0),h(D,null,A(a.value,e=>(n(),h("tr",{key:e._id,class:F({"bg-red-lighten-5":!e.product.sell})},[t("td",null,[r(H,{src:e.product.images[0],cover:"","aspect-ratio":"1"},null,8,["src"])]),t("td",{style:y(`color: ${e.product.textColor};`)},[r(s,{to:`/proHome/${e.product._id}`},{default:c(()=>[g(m(e.product.name),1)]),_:2},1032,["to"])],4),t("td",{style:y(`background-color: ${e.product.color};`)},m(e.product.price),5),t("td",null,[e.product.sell?(n(),p(b,{key:0,icon:"mdi-check"})):k("",!0),e.product.sell?k("",!0):(n(),p(b,{key:1,icon:"mdi-close"}))]),t("td",null,[r(f,{color:"primary",variant:"text",icon:"mdi-heart-broken",onClick:B=>x(e.product._id)},null,8,["onClick"]),q,e.product.sell?(n(),p(f,{key:0,color:"primary",variant:"text",icon:"mdi-cart",onClick:B=>V(e.product._id)},null,8,["onClick"])):k("",!0)])],2))),128)),t("tr",null,[a.value.length===0?(n(),h("td",E,"沒有收藏")):k("",!0)])])]),_:1})]),_:1}),r(_,{cols:"12",class:"text-center"},{default:c(()=>[t("p",null,"總收藏:"+m(a.value.length),1)]),_:1}),r(_,{cols:"12",class:"text-center"},{default:c(()=>[r(f,{color:"green",onClick:w,disabled:!C.value},{default:c(()=>[g("全部加入購物車")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})}}};export{M as default};
